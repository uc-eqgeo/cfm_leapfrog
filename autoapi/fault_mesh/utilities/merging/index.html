

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>fault_mesh.utilities.merging &mdash; cfm-leapfrog 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="fault_mesh.utilities.meshing" href="../meshing/index.html" />
    <link rel="prev" title="fault_mesh.utilities.graph" href="../graph/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            cfm-leapfrog
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction and Setup:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../help/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../help/preparation.html">Preparing inputs for use</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../help/install.html">Installation instructions and updates to code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../help/running_examples.html">Running tutorial examples using Jupyter</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/define_connected.html">Defining connected fault systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/define_connected.html#defining-a-cutting-hierarchy">Defining a cutting hierarchy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/define_connected.html#create-shapefiles-for-mesh-creation">Create shapefiles for mesh creation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Meshing in Leapfrog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../help/camilla.html">Leapfrog 3D mesh generation and fault cutting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python Examples (Japanese):</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/define_connected_japanese.html">接続された断層システムの定義</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/define_connected_japanese.html#id6">切断階層の定義</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/define_connected_japanese.html#id9">メッシュ作成のためのシェープファイルの作成</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">fault_mesh</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../faults/index.html">fault_mesh.faults</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/index.html">fault_mesh.io</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html">fault_mesh.utilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">cfm-leapfrog</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">fault_mesh</a></li>
          <li class="breadcrumb-item"><a href="../index.html">fault_mesh.utilities</a></li>
      <li class="breadcrumb-item active">fault_mesh.utilities.merging</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/fault_mesh/utilities/merging/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-fault_mesh.utilities.merging">
<span id="fault-mesh-utilities-merging"></span><h1>fault_mesh.utilities.merging<a class="headerlink" href="#module-fault_mesh.utilities.merging" title="Link to this heading"></a></h1>
<p>Functions for merging segments that are nearly adjacent.
This module provides functions to align and merge line segments that are close to each other.
It includes functions to densify line segments, align two nearly adjacent segments, merge two nearly adjacent segments, and merge multiple nearly adjacent segments. The merging process is based on the distance between the segments and can be customized with a tolerance parameter.
The functions are designed to work with Shapely LineString objects and can be used in geospatial applications where line segments need to be combined or aligned.</p>
<dl class="simple">
<dt>Functions:</dt><dd><ul class="simple">
<li><p>densify_line: Densifies a LineString by adding interpolated points along the line.</p></li>
<li><p>align_two_nearly_adjacent_segments: Aligns two nearly adjacent line segments by moving their closest endpoints to a common midpoint.</p></li>
<li><p>merge_two_nearly_adjacent_segments: Merges two nearly adjacent line segments into a single line.</p></li>
<li><p>merge_multiple_nearly_adjacent_segments: Merges multiple line segments that are nearly adjacent to each other.</p></li>
<li><p>sorted_merge: Merges a list of LineString segments into a single LineString by iteratively combining the nearest segments.</p></li>
</ul>
</dd>
</dl>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#fault_mesh.utilities.merging.densify_line" title="fault_mesh.utilities.merging.densify_line"><code class="xref py py-obj docutils literal notranslate"><span class="pre">densify_line</span></code></a>(line[, density])</p></td>
<td><p>Densify a LineString by adding interpolated points along the line.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fault_mesh.utilities.merging.align_two_nearly_adjacent_segments" title="fault_mesh.utilities.merging.align_two_nearly_adjacent_segments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">align_two_nearly_adjacent_segments</span></code></a>(segment_list[, ...])</p></td>
<td><p>Aligns two nearly adjacent line segments by moving their closest endpoints to a common midpoint.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fault_mesh.utilities.merging.merge_two_nearly_adjacent_segments" title="fault_mesh.utilities.merging.merge_two_nearly_adjacent_segments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_two_nearly_adjacent_segments</span></code></a>(segment_list[, ...])</p></td>
<td><p>Merge two nearly adjacent line segments into a single line.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#fault_mesh.utilities.merging.merge_multiple_nearly_adjacent_segments" title="fault_mesh.utilities.merging.merge_multiple_nearly_adjacent_segments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_multiple_nearly_adjacent_segments</span></code></a>(segment_list)</p></td>
<td><p>Merge multiple line segments that are nearly adjacent to each other.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#fault_mesh.utilities.merging.sorted_merge" title="fault_mesh.utilities.merging.sorted_merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sorted_merge</span></code></a>(seg_list[, tolerance, densify])</p></td>
<td><p>Merges a list of LineString segments into a single LineString by iteratively combining the nearest segments.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="fault_mesh.utilities.merging.densify_line">
<span class="sig-prename descclassname"><span class="pre">fault_mesh.utilities.merging.</span></span><span class="sig-name descname"><span class="pre">densify_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fault_mesh.utilities.merging.densify_line" title="Link to this definition"></a></dt>
<dd><p>Densify a LineString by adding interpolated points along the line.
This function takes a LineString and adds points at regular intervals
determined by the density parameter. The original points are preserved,
and the result is a LineString with a higher density of points.
:param line: The input LineString to be densified
:type line: LineString
:param density: The interval between interpolated points along the line, defaults to 1.3
:type density: float, optional
:return: A new LineString with additional interpolated points
:rtype: LineString</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line</strong> (<em>shapely.geometry.LineString</em>)</p></li>
<li><p><strong>density</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fault_mesh.utilities.merging.align_two_nearly_adjacent_segments">
<span class="sig-prename descclassname"><span class="pre">fault_mesh.utilities.merging.</span></span><span class="sig-name descname"><span class="pre">align_two_nearly_adjacent_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segment_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">densify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fault_mesh.utilities.merging.align_two_nearly_adjacent_segments" title="Link to this definition"></a></dt>
<dd><p>Aligns two nearly adjacent line segments by moving their closest endpoints to a common midpoint.
This function takes two LineString objects that are within a specified distance tolerance of each other
and aligns them by replacing their closest endpoints with a common midpoint. The function can optionally
densify the line segments before alignment to improve the precision of the closest-point determination.
:param segment_list: List containing exactly two LineString objects that need to be aligned
:param tolerance: Maximum distance between segments to be considered for alignment, defaults to 200.
:param densify: Distance between points when densifying the lines, defaults to 1.e3.</p>
<blockquote>
<div><p>If None, lines are not densified.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing two aligned LineString objects</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple(LineString, LineString)</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>AssertionError</strong> – If segment_list doesn’t contain exactly 2 LineStrings</p></li>
<li><p><strong>AssertionError</strong> – If the distance between the two LineStrings exceeds the tolerance</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>segment_list</strong> (<em>List</em><em>[</em><em>shapely.geometry.LineString</em><em>]</em>)</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>)</p></li>
<li><p><strong>densify</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fault_mesh.utilities.merging.merge_two_nearly_adjacent_segments">
<span class="sig-prename descclassname"><span class="pre">fault_mesh.utilities.merging.</span></span><span class="sig-name descname"><span class="pre">merge_two_nearly_adjacent_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segment_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">densify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fault_mesh.utilities.merging.merge_two_nearly_adjacent_segments" title="Link to this definition"></a></dt>
<dd><p>Merge two nearly adjacent line segments into a single line.
This function takes two line segments that are close to each other (within a specified tolerance)
and merges them into a single continuous LineString. It first aligns the segments using
the align_two_nearly_adjacent_segments function, and then merges them.
:param segment_list: List containing two LineString objects to be merged
:param tolerance: Maximum distance between endpoints for segments to be considered adjacent, defaults to 200.
:param densify: Distance between points when densifying lines for better alignment, defaults to 1.e3
:return: A single merged LineString created from the two input segments
:rtype: LineString</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segment_list</strong> (<em>List</em><em>[</em><em>shapely.geometry.LineString</em><em>]</em>)</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>)</p></li>
<li><p><strong>densify</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fault_mesh.utilities.merging.merge_multiple_nearly_adjacent_segments">
<span class="sig-prename descclassname"><span class="pre">fault_mesh.utilities.merging.</span></span><span class="sig-name descname"><span class="pre">merge_multiple_nearly_adjacent_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segment_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">densify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fault_mesh.utilities.merging.merge_multiple_nearly_adjacent_segments" title="Link to this definition"></a></dt>
<dd><p>Merge multiple line segments that are nearly adjacent to each other.
This function takes a list of LineString objects and merges them into a single LineString
if they are within the specified tolerance distance of each other. If there are only
two segments, it uses merge_two_nearly_adjacent_segments; otherwise, it uses sorted_merge.
:param segment_list: List of LineString objects to be merged
:param tolerance: Maximum distance between segments to be considered for merging, defaults to 200.0
:param densify: Distance between points when densifying the lines, set to None to skip densification, defaults to 1.0e3
:return: A merged LineString containing all input segments
:rtype: LineString</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segment_list</strong> (<em>List</em><em>[</em><em>shapely.geometry.LineString</em><em>]</em>)</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>)</p></li>
<li><p><strong>densify</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>None</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="fault_mesh.utilities.merging.sorted_merge">
<span class="sig-prename descclassname"><span class="pre">fault_mesh.utilities.merging.</span></span><span class="sig-name descname"><span class="pre">sorted_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">densify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#fault_mesh.utilities.merging.sorted_merge" title="Link to this definition"></a></dt>
<dd><p>Merges a list of LineString segments into a single LineString by iteratively combining the nearest segments.
This function starts with the southernmost segment (minimum y-coordinate of centroid) and
repeatedly merges it with the nearest remaining segment until all segments are included.
:param seg_list: List of LineString segments to be merged
:param tolerance: Maximum distance allowed between segments for merging, defaults to 200.
:param densify: Distance between points when densifying segments for better merging results, defaults to 1.e3
:return: A single LineString representing the merged segments
:rtype: LineString</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg_list</strong> (<em>List</em><em>[</em><em>shapely.geometry.LineString</em><em>]</em>)</p></li>
<li><p><strong>tolerance</strong> (<em>float</em>)</p></li>
<li><p><strong>densify</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../graph/index.html" class="btn btn-neutral float-left" title="fault_mesh.utilities.graph" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../meshing/index.html" class="btn btn-neutral float-right" title="fault_mesh.utilities.meshing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Andy Howell and Camilla Penney.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>